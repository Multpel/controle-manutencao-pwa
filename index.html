<script>
// Funções de navegação das telas
function showScreen(screenId, modo) {
  const screens = document.querySelectorAll('.screen');
  screens.forEach(screen => screen.style.display = 'none');
  const mainMenu = document.getElementById('main-menu');
  if (mainMenu) mainMenu.style.display = 'none';

  if (screenId === 'main-menu') {
    if (mainMenu) mainMenu.style.display = 'block';
    console.log('Menu principal exibido');
  } else {
    const targetScreen = document.getElementById(screenId);
    if (targetScreen) {
      targetScreen.style.display = 'block';
      // Reset form em "novo cadastro"
      if (screenId === 'cadastro-equipamento-screen' && modo === 'novo') {
        const form = document.getElementById('equipamento-form');
        if (form) {
          form.reset();
          form.dataset.mode = "add";
          form.dataset.editId = "";
        }
      }
    }
  }
}

function navigateToScreen(screenId) {
  console.log('→ Navegando para:', screenId);
  showScreen(screenId);
  // Carregar dados específicos dependendo da tela
  setTimeout(() => {
    if (screenId === 'equipamentos-screen') {
      carregarEquipamentosDoFirestore();
    } else if (screenId === 'agenda-screen') {
      loadAgenda();
    } else if (screenId === 'pendentes-screen') {
      loadPendentes();
    } else if (screenId === 'realizadas-screen') {
      loadRealizadas();
    } else if (screenId === 'relatorios-screen') {
      loadRelatorios();
    }
  }, 100);
}

function backToMenu() {
  console.log('← Voltando ao menu');
  showScreen('main-menu');
}

function exitApp() {
  if (confirm('Deseja realmente sair da aplicação?')) {
    window.location.href = 'about:blank';
  }
}

// Listener dos botões do menu principal (inclui o botão SAIR sem data-target)
document.addEventListener('DOMContentLoaded', function() {
  const menuItems = document.querySelectorAll('.menu-item');
  menuItems.forEach(item => {
    item.addEventListener('click', function(e) {
      e.preventDefault();
      const targetScreen = this.getAttribute('data-target-screen');
      if (targetScreen) {
        navigateToScreen(targetScreen);
      } else {
        // Se não tem data-target-screen, executa SAIR
        exitApp();
      }
    });
  });

  // Demais listeners do app...
  // Exemplo:
  const backBtns = document.querySelectorAll('.btn-back');
  backBtns.forEach(btn => btn.addEventListener('click', backToMenu));
  // Adapte para o seu projeto!
});

// Funções stub para evitar erro em navegação
function carregarEquipamentosDoFirestore() { /* ... */ }
function loadAgenda() { /* ... */ }
function loadPendentes() { /* ... */ }
function loadRealizadas() { /* ... */ }
function loadRelatorios() { /* ... */ }
</script>
<script type="module" src="src/app.js"></script>
